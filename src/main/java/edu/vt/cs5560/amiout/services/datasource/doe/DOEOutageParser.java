package edu.vt.cs5560.amiout.services.datasource.doe;

import edu.vt.cs5560.amiout.data.DOE.order.*;
import edu.vt.cs5560.amiout.domain.parsers.OutageSample;
import edu.vt.cs5560.amiout.services.datasource.DataFileSource;
import edu.vt.cs5560.amiout.services.preprocessing.GeoEncodeResult;
import edu.vt.cs5560.amiout.services.preprocessing.GeoEncodeResultMulti;
import edu.vt.cs5560.amiout.services.preprocessing.GeoEncoder;
import edu.vt.cs5560.amiout.utils.LossyParser;
import edu.vt.cs5560.amiout.utils.csv.POJO2CSV;
import org.apache.commons.lang3.StringUtils;
import org.apache.poi.openxml4j.exceptions.InvalidFormatException;
import org.apache.poi.ss.usermodel.*;
import org.assertj.core.util.Lists;

import java.io.File;
import java.io.IOException;
import java.security.KeyManagementException;
import java.security.KeyStoreException;
import java.security.NoSuchAlgorithmException;
import java.sql.*;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.*;
import java.util.Date;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class DOEOutageParser
{
    private static final GeoEncoder geoEncoder = new GeoEncoder();
   // DataFileSource doeSource = new DOEOutageFileScraper(); load files statically so we don't take down the government site....
    private static final DataFileSource doeSource = new DOEOutageStaticLoader();
    private static DateFormat sqlFormat = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss");

    public static void main(String [] args) throws Exception
    {
        // Get all of the XLS files available for download
        List<File> excelFiles = doeSource.retrieveFiles();

        // Parse each excel file
        List<OutageSample> outages = parseOutagesFromExcelFiles(excelFiles);
        writeToDb(outages);
    }

    /**
     * TODO: DO THIS ONCE DATA IS INGESTED:
     *
     UPDATE outages
     SET areaaffected = ST_MakeValid(areaaffected)
     CREATE INDEX outage_geo_gix ON outages;

     USING GIST (areaaffected);

     CREATE INDEX regions_partition_geo_gix ON regions_partition
     USING GIST (wkb_geometry);
     CREATE INDEX counties_partition_geo_gix ON counties_partition
     USING GIST (wkb_geometry);
     CREATE INDEX states_partition_geo_gix ON states_partition
     USING GIST (wkb_geometry);


     create index daterange_idx on outages using gist(daterange);

     create index weatherdate_idx on weather using gist(lst_date);
     create index weatherdate_idx on weather using gist(geom);

     -- HAVE TO BE EXECUTED IN THEIR OWN TRANSATION
     VACUUM ANALYZE outages;
     VACUUM ANALYZE regions_partition;
     VACUUM ANALYZE counties_partition;
     VACUUM ANALYZE states_partition;
     VACUUM ANALYZE weather;

     * @param samples
     * @throws SQLException
     * @throws ClassNotFoundException
     * @throws InterruptedException
     * @throws NoSuchAlgorithmException
     * @throws KeyStoreException
     * @throws KeyManagementException
     * @throws IOException
     */
    private static void writeToDb(List<OutageSample> samples) throws SQLException, ClassNotFoundException, InterruptedException, NoSuchAlgorithmException, KeyStoreException, KeyManagementException, IOException {
        boolean limit = true;
        int count = 0;
        Connection c = initConnection();
        PreparedStatement stmt = null;
        Statement s = null;
        String sql = "INSERT INTO outages(id, nercregion, disturbanceType, energyLoss, customersAffected,"
                + " dateRange, areaaffected" +
                ") VALUES(?,?,?,?,?,?, ST_GeomFromText('MULTIPOLYGON(GEO_DATA)',4326))";

        for (OutageSample sample : samples)
        {
            stmt = c.prepareStatement(sql);
            stmt.setInt(1, count++);

            stmt.setString(2, sample.getNercRegion().toString() != null ? sample.getNercRegion().toString() : null);
            stmt.setString(3, sample.getDisturbanceType() != null ? sample.getDisturbanceType() : null);
            stmt.setInt(4, sample.getEnergyLossInMegaWatts() != null ? sample.getEnergyLossInMegaWatts() : -1);
            stmt.setInt(5, sample.getNumCustomersAffected() != null ? sample.getNumCustomersAffected() : -1);

            // set date range. If end date is not set, assume outage lasted for one day.
            Date endDate = sample.getRestorationDateTime() != null ? sample.getRestorationDateTime() :
                    new Date(sample.getDateTimeOcurred().getTime() +  24 * 60 * 60 * 1000);
            stmt.setObject(6, "["+sqlFormat.format(sample.getDateTimeOcurred())+", "+sqlFormat.format(endDate)+"]");

            if (sample.getAreaAffected().contains("Arkansas: Mississippi: Louisiana: Texas:"))
                System.out.println("ASD");
            // Gather geo location for all areas mentioned in the outage data
            List<String> locations = getLocations(sample.getAreaAffected());
            List<Object> geoEncodedLocations = new LinkedList<>();
            for (String location : locations)
            {
                Object o = geoEncoder.getGeoEncodeForLocation(location);
                if (o != null)
                    geoEncodedLocations.add(o);
            }

            // Construct multipolygon from all locations
            StringBuilder finalMultiPolygon = new StringBuilder();
            for (int i = 0; i < geoEncodedLocations.size(); i++)
            {

                finalMultiPolygon.append(getSqlDataForGeometry(geoEncodedLocations.get(i)));
                if (i < geoEncodedLocations.size() - 1)
                    finalMultiPolygon.append(",");
            }

            String fullPreparedStatement = stmt.toString();
            fullPreparedStatement = fullPreparedStatement.replaceAll("GEO_DATA", finalMultiPolygon.toString());
            try {
                s = c.createStatement();
                s.executeUpdate(fullPreparedStatement);
            }
            catch(Exception e)
            {
                e.printStackTrace();
            }
        }

        s.close();
        stmt.close();
        c.commit();
        c.close();
    }

    private static String getSqlDataForGeometry(Object o)
    {
        if (o instanceof GeoEncodeResult)
            return convertGeoEncodedPolygonToSQLData(((GeoEncodeResult) o).getGeoJsonPolygon().getCoordinates());
        else
        {
            double[][][][] multipolys = ((GeoEncodeResultMulti) o).geoJsonPolygon.getCoordinates();
            StringBuilder builder = new StringBuilder();
            for (int i = 0; i < multipolys.length; i++) {
                builder.append(convertGeoEncodedPolygonToSQLData(multipolys[i]));
                if (i < multipolys.length - 1)
                    builder.append(",");
            }

          return builder.toString();
        }
    }

//(-90.310298 35.004295,-90.309297 34.995694,-90.307749 34.995694,-90.305891 34.995694,-90.304914 34.995694,-90.304033 34.995694,-90.303097 34.995694,-90.296412 34.995586,-90.293621 34.995541,-90.293578 34.995541,-90.293574 34.99554,-90.293563 34.99554,-90.29356 34.99554,-90.290696 34.995494,-90.288295 34.995494,-90.273011 34.995498,-90.272499 34.995498,-90.267234 34.995505,-90.267147 34.995505,-90.267017 34.995506,-90.266886 34.995506,-90.266873 34.995506,-90.2668 34.995506,-90.263601 34.995509,-90.254006 34.995522,-90.251618 34.995525,-90.251521 34.995525,-90.250808 34.995526,-90.25076 34.995526,-90.250711 34.995526,-90.250617 34.995526,-90.25057 34.995526,-90.250522 34.995526,-90.250486 34.995526,-90.25038 34.995526,-90.250333 34.995526,-90.249888 34.995526,-90.248553 34.995528,-90.248109 34.995529,-90.246957 34.99553,-90.244829 34.995532,-90.237724 34.995542,-90.234991 34.995517,-90.231712 34.995488,-90.229842 34.995471,-90.226446 34.995441,-90.225869 34.995436,-90.225706 34.995434,-90.225542 34.995433,-90.224235 34.995421,-90.223571 34.995415,-90.222366 34.995405,-90.222207 34.995403,-90.22173 34.995399,-90.221571 34.995398,-90.221256 34.995395,-90.22011 34.995384,-90.215729 34.995345,-90.214269 34.995332,-90.211173 34.995304,-90.211147 34.995304,-90.201887 34.995221,-90.199308 34.995198,-90.198792 34.995193,-90.198243 34.995188,-90.196599 34.995173,-90.196342 34.995171,-90.196285 34.995171,-90.196051 34.995169,-90.195886 34.995167,-90.19572 34.995166,-90.187073 34.995088,-90.167012 34.994909,-90.160141 34.994863,-90.151258 34.994805,-90.151164 34.994804,-90.150695 34.9948,-90.149993 34.994796,-90.14929 34.994791,-90.149 34.994789,-90.148822 34.994788,-90.148233 34.994784,-90.146469 34.994772,-90.145881 34.994769,-90.145522 34.994767,-90.144676 34.994761,-90.144238 34.994758,-90.142043 34.994743,-90.14204 34.994743,-90.139312 34.994724,-90.13767 34.994714,-90.137665 34.994714,-90.137651 34.994714,-90.137647 34.994714,-90.137466 34.994713,-90.137428 34.994713,-90.136925 34.994709,-90.136745 34.994708,-90.136063 34.994706,-90.134917 34.994702,-90.131723 34.994694,-90.129434 34.994688,-90.129245 34.994688,-90.129102 34.994688,-90.128959 34.994687,-90.127607 34.994684,-90.127554 34.994684,-90.127399 34.994684,-90.127347 34.994685,-90.1241 34.994693,-90.123988 34.994693,-90.123741 34.994694,-90.123494 34.994694,-90.122535 34.994696,-90.12213 34.994698,-90.117123 34.99471,-90.116984 34.99471,-90.116846 34.994711,-90.116527 34.994711,-90.116434 34.994712,-90.11634 34.994712,-90.115845 34.994713,-90.115705 34.994713,-90.110439 34.994727,-90.108102 34.994733,-90.103482 34.994745,-90.103291 34.994745,-90.1019 34.994748,-90.097728 34.994758,-90.096338 34.994762,-90.096111 34.994763,-90.09543 34.994768,-90.095311 34.994769,-90.095204 34.99477,-90.093935 34.994779,-90.091266 34.994799,-90.090129 34.994807,-90.088861 34.994817,-90.088619 34.994818,-90.087896 34.994824,-90.087762 34.994825,-90.087655 34.994826,-90.087408 34.994827,-90.086669 34.994833,-90.086423 34.994835,-90.08483 34.994846,-90.080052 34.994881,-90.07846 34.994893,-90.075391 34.994916,-90.074924 34.994914,-90.064319 34.994869,-90.063044 34.994864,-90.060784 34.994854,-90.059431 34.994857,-90.055373 34.994867,-90.054003 34.994871,-90.053998 34.994871,-90.052764 34.994874,-90.051823 34.994882,-90.045233 34.994944,-90.044794 34.994949,-90.043036 34.994964,-90.042672 34.994961,-90.041583 34.994952,-90.04122 34.99495,-90.041158 34.994949,-90.039241 34.994931,-90.033307 34.994878,-90.031548 34.994863,-90.031329 34.994861,-90.030341 34.994861,-90.030077 34.99486,-90.026323 34.994858,-90.025072 34.994858,-90.023336 34.994868,-90.018128 34.9949,-90.016393 34.994911,-90.015408 34.994916,-90.012456 34.994935,-90.011472 34.994941,-90.011244 34.994942,-90.010563 34.994946,-90.010336 34.994948,-90.010124 34.994949,-90.009492 34.994952,-90.0092945 34.9949534,-90.009055 34.994955,-90.008379 34.994959,-90.008154 34.994961,-90.007569 34.994963,-90.005816 34.994973,-90.005453 34.994976,-90.005232 34.994979,-90.004889 34.994982,-90.003863 34.994991,-90.00352 34.994993,-90.003325 34.994994,-90.002743 34.994998,-90.002549 34.995,-90.002491 34.995,-90.002321 34.995001,-90.002264 34.995002,-90.002254 34.995002,-90.002226 34.995002,-90.002217 34.995003,-90.00212 34.995003,-90.0019689 34.995004,-89.997044 34.9950384,-89.992271 34.995072,-89.989906 34.9950769,-89.988875 34.995084,-89.985785 34.995072,-89.985348 34.995071,-89.985023 34.99507,-89.984755 34.995069,-89.983907 34.995065,-89.981363 34.995055,-89.980516 34.995052,-89.978852 34.995045,-89.978703 34.995045,-89.9764933 34.9950587,-89.976101 34.995035,-89.97386 34.995026,-89.973183 34.995024,-89.972197 34.99502,-89.970449 34.995012,-89.968975 34.995007,-89.965205 34.994991,-89.963458 34.994985,-89.963416 34.994984,-89.963291 34.994984,-89.96325 34.994984,-89.961779 34.994978,-89.957367 34.994961,-89.957052 34.99496,-89.955897 34.994955,-89.95415 34.994947,-89.953416 34.994945,-89.953252 34.994944,-89.953088 34.994943,-89.952928 34.994943,-89.948909 34.994926,-89.947163 34.994919,-89.946734 34.994917,-89.945447 34.994911,-89.945019 34.99491,-89.943555 34.994904,-89.943365 34.994903,-89.938407 34.994882,-89.93717 34.994877,-89.936754 34.994876,-89.934615 34.994865,-89.934009 34.994863,-89.928201 34.994839,-89.926831 34.994834,-89.92618 34.994831,-89.926063 34.994831,-89.92479 34.994825,-89.924398 34.994824,-89.924252 34.994823,-89.924105 34.994823,-89.920972 34.994808,-89.920752 34.994808,-89.9197 34.994803,-89.9196 34.994802,-89.919303 34.994801,-89.919204 34.994801,-89.919169 34.9948,-89.919066 34.9948,-89.9190249 34.994802,-89.918959 34.994799,-89.918743 34.994796,-89.918671 34.994796,-89.917605 34.994784,-89.915337 34.99476,-89.915229 34.994759,-89.91323 34.994745,-89.911797 34.994735,-89.910519 34.99472,-89.909434 34.994719,-89.904905 34.994686,-89.904522 34.994684,-89.90143 34.9946658,-89.899849 34.994629,-89.898169 34.994595,-89.896481 34.99456,-89.896256 34.994555,-89.89603 34.99455,-89.895547 34.99454,-89.895064 34.994531,-89.895006 34.994529,-89.893452 34.994497,-89.893449 34.994496,-89.893392 34.994495,-89.893386 34.994492,-89.893264 34.994489,-89.89288 34.994483,-89.892753 34.994481,-89.892543 34.994477,-89.89208 34.994469,-89.891915 34.99447,-89.891706 34.994472,-89.891669 34.994472,-89.891503 34.99447,-89.891064 34.994468,-89.890981 34.994468,-89.890897 34.994467,-89.890815 34.994467,-89.890696 34.994466,-89.89069 34.994466,-89.890673 34.994466,-89.890668 34.994466,-89.890459 34.994465,-89.890232 34.994464,-89.890026 34.994463,-89.889833 34.994461,-89.889625 34.99446,-89.887272 34.994436,-89.886983 34.994427,-89.886691 34.994428,-89.883892 34.994392,-89.883764 34.994393,-89.883748 34.994393,-89.882748 34.994392,-89.879751 34.994392,-89.879277 34.994392,-89.878752 34.994392,-89.878683 34.994392,-89.878595 34.994392,-89.878478 34.994392,-89.87841 34.994392,-89.8784 34.994379,-89.878373 34.99434,-89.878364 34.994327,-89.877045 34.99432,-89.873088 34.994299,-89.871774 34.994293,-89.871699 34.994292,-89.871489 34.994291,-89.871419 34.994291,-89.871244 34.99429,-89.870867 34.994288,-89.870812 34.994288,-89.870721 34.994287,-89.870547 34.994286,-89.86995 34.994283,-89.868162 34.994274,-89.867566 34.994271,-89.867289 34.99427,-89.867184 34.994269,-89.866329 34.994266,-89.866166 34.994265,-89.86604 34.994264,-89.866002 34.994264,-89.865659 34.994263,-89.865556 34.994262,-89.865248 34.994259,-89.865146 34.994259,-89.864476 34.994255,-89.862468 34.994245,-89.861799 34.994242,-89.859114 34.994228,-89.855609 34.99421,-89.851384 34.994188,-89.851062 34.994211,-89.848385 34.994409,-89.847229 34.994397,-89.846998 34.994395,-89.846829 34.994392,-89.846081 34.994408,-89.846027 34.994407,-89.845868 34.994405,-89.845521 34.994404,-89.844976 34.994406,-89.844435 34.994411,-89.843761 34.994416,-89.843606 34.994418,-89.842728 34.994416,-89.8426009 34.9943948,-89.84218 34.994415,-89.842118 34.994415,-89.840668 34.994428,-89.840655 34.994428,-89.840168 34.994452,-89.840111 34.994453,-89.839942 34.994458,-89.839886 34.994461,-89.839767 34.994465,-89.839464 34.994465,-89.838199 34.994468,-89.838079 34.994469,-89.837842 34.994484,-89.83778 34.994499,-89.837761 34.994478,-89.837737 34.994465,-89.837685 34.994437,-89.837581 34.99442,-89.837527 34.994412,-89.836653 34.994427,-89.836238 34.994437,-89.836159 34.994437,-89.835259 34.994439,-89.834689 34.994451,-89.834237 34.994455,-89.833195 34.994463,-89.832548 34.994492,-89.832057 34.9945,-89.831741 34.994506,-89.830807 34.994507,-89.83069 34.994498,-89.83059 34.994497,-89.830291 34.994494,-89.830192 34.994494,-89.829653 34.994489,-89.828726 34.994493,-89.827387 34.994499,-89.8273442 34.994565,-89.826782 34.994502,-89.826207 34.994504,-89.825056 34.994503,-89.824364 34.9945336,-89.824328 34.994502,-89.823532 34.994502,-89.823491 34.994502,-89.823215 34.994503,-89.822863 34.994503,-89.822597 34.994503,-89.821801 34.994503,-89.821536 34.994504,-89.821503 34.994504,-89.821405 34.994504,-89.820939 34.994505,-89.819636 34.994509,-89.819203 34.994511,-89.818971 34.994512,-89.818278 34.994515,-89.818047 34.994517,-89.81802 34.994517,-89.817941 34.994517,-89.817915 34.994517,-89.817628 34.994517,-89.816766 34.99452,-89.81648 34.994521,-89.816419 34.994521,-89.816237 34.994521,-89.816177 34.994522,-89.816153 34.994522,-89.816091 34.994523,-89.815835 34.994528,-89.81575 34.99453,-89.81572 34.99453,-89.815631 34.994532,-89.815602 34.994533,-89.815506 34.994533,-89.815108 34.994529,-89.814604 34.994525,-89.813626 34.994517,-89.813133 34.994514,-89.813053 34.994513,-89.812097 34.994519,-89.810158 34.994532,-89.80899 34.994536,-89.807955 34.994541,-89.807353 34.994544,-89.805435 34.99455,-89.80421 34.994554,-89.80362 34.994554,-89.802837 34.994555,-89.802246 34.994557,-89.80207 34.994554,-89.801371 34.994557,-89.800175 34.994563,-89.799422 34.994566,-89.797876 34.994573,-89.797085 34.994578,-89.795651 34.994577,-89.795357 34.994564,-89.795037 34.99457,-89.793754 34.994556,-89.792377 34.994542,-89.792192 34.994543,-89.790305 34.994551,-89.7848584 34.9946037,-89.7846152 34.9946047,-89.7843711 34.9946056,-89.7843141 34.9946058,-89.7833739 34.9946094,-89.7831398 34.9946102,-89.7830608 34.9946105,-89.7773805 34.9946321,-89.768413 34.994666,-89.764406 34.99472,-89.75986 34.994783,-89.741785 34.995194,-89.7287912 34.9952072,-89.7242359 34.9952118,-89.6616777 34.9952753,-89.644282 34.995293,-89.6194142 34.9951806,-89.6024252 34.9951238,-89.5649558 34.9949724,-89.5111353 34.9947502,-89.493739 34.994361,-89.486897 34.993975,-89.4845982 34.9939652,-89.4845699 34.9939651,-89.4819643 34.993954,-89.4409981 34.9937797,-89.434954 34.993754,-89.4057047 34.9938851,-89.3983405 34.9939181,-89.3526769 34.9941228,-89.233405 34.9946574,-89.217433 34.994729,-89.198288 34.994484,-89.19374 34.9944228,-89.156827 34.993926,-89.139136 34.994307,-89.138997 34.99433,-89.0885169 34.994611,-89.0329815 34.9949201,-89.02654 34.994956,-89.0230334 34.9949521,-89.0171271 34.9949454,-88.9646261 34.9948863,-88.9585939 34.9948795,-88.931471 34.994849,-88.925241 34.994842,-88.8909693 34.995761,-88.886979 34.995868,-88.8584098 34.9952456,-88.8538917 34.9951472,-88.851037 34.995085,-88.8230648 34.995167,-88.786612 34.995252,-88.720734 34.9954144,-88.6844383 34.9955039,-88.6063631 34.9956965,-88.5310457 34.9958822,-88.5285081 34.9958884,-88.5190554 34.9959117,-88.5186607 34.9959119,-88.5141803 34.9959237,-88.5049576 34.9959465,-88.487609 34.9959893,-88.4865255 34.9959919,-88.4788665 34.9960108,-88.47298 34.9960253,-88.469877 34.996033,-88.469801 34.996052,-88.380508 34.99561,-88.3635285 34.9955896,-88.258111 34.995463,-88.2561618 34.9954774,-88.253825 34.995553,-88.2518117 34.995556,-88.2003353 34.9956336,-88.2000237 34.9956045,-88.2010054 34.9993506,-88.2015222 35.0037949,-88.2022973 35.0065884,-88.202969 35.0081121,-88.195917 35.0079765,-88.000032 35.005939,-87.9869914 35.005959,-87.9734949 35.0058366,-87.926893 35.0056568,-87.877969 35.005468,-87.877742 35.005512,-87.872626 35.005571,-87.853528 35.005541,-87.853411 35.005576,-87.851886 35.005656,-87.8212569 35.0053782,-87.773586 35.004946,-87.767602 35.004783,-87.75889 35.004711,-87.709491 35.004089,-87.702321 35.003945,-87.700543 35.003988,-87.696834 35.003852,-87.6886228 35.0037503,-87.671405 35.003537,-87.664123 35.003523,-87.625025 35.003732,-87.6103596 35.003662,-87.5826286 35.0035297,-87.5773317 35.0035045,-87.5364391 35.0033094,-87.4928217 35.0031013,-87.4432457 35.0028648,-87.4373083 35.0028365,-87.428613 35.002795,-87.421543 35.002679,-87.4174 35.002669,-87.391314 35.002374,-87.381071 35.002118,-87.359281 35.001823,-87.349251 35.001662,-87.299185 35.000915,-87.270014 35.00039,-87.230544 34.999484,-87.2234764 34.9993142,-87.216683 34.999148,-87.2105607 34.9990092,-87.162752 34.9980951,-87.1396198 34.9976474,-87.1225667 34.9973175,-87.0301198 34.9955286,-87.011174 34.995162,-87.000007 34.995121,-86.9887928 34.9948546,-86.974412 34.994513,-86.972613 34.99461,-86.970236 34.994546,-86.96712 34.9944,-86.9273438 34.9934739,-86.879166 34.9923522,-86.862147 34.991956,-86.8573739 34.9919436,-86.849794 34.991924,-86.846466 34.99186,-86.8366927 34.9917716,-86.820657 34.991764,-86.8193931 34.9917695,-86.783403 34.991925,-86.677616 34.99207,-86.676726 34.99207,-86.67436 34.992001,-86.670853 34.992,-86.65961 34.991792,-86.641212 34.99174,-86.600039 34.99124,-86.588962 34.991197,-86.571217 34.991011,-86.555864 34.990971,-86.528485 34.990677,-86.5234314 34.9906782,-86.4874938 34.9906871,-86.4731688 34.9906907,-86.467798 34.990692,-86.433927 34.991085,-86.397203 34.99166,-86.3777158 34.9915325,-86.3212578 34.9911633,-86.3186927 34.9911465,-86.3106782 34.991098,-86.2535287 34.990747,-86.2055423 34.9904553,-86.1795389 34.9902973,-86.1530465 34.9901363,-86.0729557 34.9896495,-86.0670872 34.9896138,-86.0669353 34.9896129,-86.0613539 34.989579,-85.9309576 34.9887864,-85.9043793 34.9886248,-85.8980778 34.9885865,-85.8649772 34.9883853,-85.8609954 34.9883611,-85.828724 34.988165,-85.824411 34.988142,-85.8225654 34.9881128,-85.8086302 34.9878927,-85.8078196 34.9878799,-85.8075822 34.9878761,-85.7266554 34.9865975,-85.71994 34.9864863,-85.7020976 34.9862095,-85.700327 34.9861815,-85.6949309 34.9859927,-85.6127712 34.9847982,-85.6114179 34.9847768,-85.6052418 34.98461,-85.5975115 34.9844556,-85.5865991 34.9842209,-85.5756672 34.9840292,-85.5647255 34.9837746,-85.5099404 34.983321,-85.4880381 34.9832113,-85.4738755 34.9831838,-85.4255628 34.9829822,-85.4078262 34.9829957,-85.3949128 34.9829869,-85.3689814 34.9832817,-85.3652134 34.9833511,-85.3647249 34.9833605,-85.3639199 34.9833851,-85.345558 34.983675,-85.3443937 34.9836876,-85.3010332 34.9844892,-85.277556 34.984975,-85.2730412 34.9850017,-85.2651188 34.9850724,-85.2304046 34.9854792,-85.2219027 34.9854632,-85.220554 34.985575,-85.2180443 34.9856892,-85.216554 34.985675,-85.2112598 34.9857303,-85.2058159 34.9857871,-85.1999693 34.9858482,-85.1955906 34.9858939,-85.185905 34.985995,-85.180553 34.986075,-85.1267748 34.986396,-85.1239317 34.986413,-85.0836182 34.9866536,-85.081872 34.986664,-85.0649748 34.9867649,-85.0518092 34.9868435,-85.0507259 34.9868499,-85.0495111 34.9868572,-85.045183 34.986883,-85.045052 34.986859,-84.980046 34.9876448,-84.9768594 34.9876696,-84.81048 34.987603,-84.809184 34.987569,-84.808127 34.987592,-84.7760536 34.9877983,-84.7310213 34.9879529,-84.7274337 34.9879652,-84.7096649 34.988086,-84.7073363 34.9880824,-84.7042834 34.9880776,-84.7030214 34.9880837,-84.7014201 34.9880832,-84.699885 34.9880826,-84.6976657 34.9880921,-84.6954379 34.9881016,-84.6920133 34.9881162,-84.6887303 34.9881302,-84.6834159 34.9881406,-84.665551 34.988229,-84.6484378 34.9883019,-84.6343005 34.9883621,-84.6334347 34.9883658,-84.6329967 34.9883677,-84.6320432 34.9883718,-84.6234007 34.9884086,-84.6228444 34.988411,-84.6173573 34.9884103,-84.6162506 34.9884102,-84.6148911 34.98841,-84.6115273 34.9884096,-84.6104118 34.9884094,-84.3920062 34.9883817,-84.3824634 34.9883853,-84.359509 34.9883939,-84.3433407 34.9884,-84.321869 34.988408,-84.3157611 35.0350539,-84.3114133 35.0682589,-84.3108584 35.0724956,-84.310851 35.072552,-84.310022 35.078883,-84.308576 35.092761,-84.308437 35.093173,-84.304809 35.121702,-84.298006 35.167468,-84.2978431 35.1683492,-84.295238 35.182442,-84.2951151 35.1834632,-84.2948902 35.1851664,-84.2922902 35.206821,-84.2902182 35.2255366,-84.2899211 35.2255843,-84.2899197 35.2254298,-84.2900126 35.2253562,-84.2900601 35.2252579,-84.2900211 35.2251787,-84.2898234 35.2248783,-84.289621 35.224677,-84.287982 35.224468,-84.28322 35.226577,-84.28252 35.227877,-84.27542 35.234777,-84.260319 35.241877,-84.257719 35.246177,-84.252819 35.249477,-84.243019 35.253178,-84.240219 35.255178,-84.231818 35.264778,-84.227818 35.267878,-84.223718 35.269078,-84.216318 35.267978,-84.211818 35.266078,-84.205517 35.259679,-84.205317 35.258279,-84.202879 35.255772,-84.201717 35.247779,-84.200117 35.244679,-84.199117 35.243679,-84.192217 35.243079,-84.188417 35.239979,-84.1859701 35.2401626,-84.178516 35.240679,-84.177016 35.242379,-84.170416 35.245779,-84.168616 35.24578,-84.161316 35.24348,-84.160416 35.24388,-84.158916 35.24588,-84.155316 35.24648,-84.143124 35.246879,-84.139715 35.24618,-84.136415 35.24478,-84.133299 35.2436791,-84.1305696 35.2433642,-84.12889 35.2436791,-84.1273154 35.2444139,-84.126815 35.246481,-84.125615 35.249381,-84.124915 35.24983,-84.12115 35.250644,-84.115279 35.250438,-84.115048 35.249765,-84.114414 35.249081,-84.113314 35.248981,-84.108449 35.25033,-84.103135 35.248781,-84.10227 35.248115,-84.097508 35.247382,-84.092213 35.249981,-84.082913 35.257082,-84.082813 35.258882,-84.081117 35.261146,-84.074713 35.263182,-84.070612 35.263782,-84.063712 35.266682,-84.055712 35.268182,-84.052612 35.269982,-84.042711 35.278383,-84.036011 35.288683,-84.02911 35.2921757,-84.02791 35.292783,-84.02351 35.295783,-84.02141 35.301383,-84.02651 35.309283,-84.02871 35.310383,-84.03501 35.311983,-84.03571 35.312883,-84.03551 35.317783,-84.032479 35.325318,-84.03245 35.32653,-84.032209 35.328583,-84.030409 35.330483,-84.029377 35.333197,-84.031272 35.336438,-84.03243 35.336845,-84.038081 35.348363,-84.037494 35.34985,-84.035343 35.350833,-84.024756 35.353896,-84.023456 35.354217,-84.020188 35.357503,-84.019193 35.359569,-84.015121 35.364868,-84.0077825 35.3714839,-84.0076778 35.3715783,-84.007586 35.371661,-84.0076813 35.3726153,-84.008307 35.378883,-84.009807 35.382683,-84.0111157 35.3842721,-84.011207 35.384383,-84.011167 35.384503,-84.010982 35.385058,-84.010607 35.386183,-84.008207 35.389683,-84.008207 35.390383,-84.014107 35.397783,-84.015207 35.398483,-84.018107 35.399083,-84.018807 35.399783,-84.021507 35.404183,-84.0217816 35.4074179,-84.0206329 35.409843,-84.017607 35.411183,-84.014707 35.411983,-84.011706 35.415383,-84.005306 35.420883,-84.00225 35.422548,-83.999906 35.425201,-83.999242 35.42614,-83.998154 35.430786,-83.996619 35.433761,-83.9952834 35.4351801,-83.992568 35.438065,-83.9896792 35.4393911,-83.983233 35.44235,-83.978286 35.44782,-83.973057 35.448921,-83.973171 35.452582,-83.9722728 35.4539111,-83.971439 35.455145,-83.969845 35.455443,-83.966656 35.454941,-83.965229 35.455399,-83.9614 35.459496,-83.961054 35.462838,-83.961056 35.463738,-83.961053 35.464143,-83.957821 35.464211,-83.955416 35.463456,-83.952882 35.460635,-83.949389 35.461164,-83.942987 35.465084,-83.942172 35.467254,-83.937015 35.471511,-83.929743 35.47333,-83.9284647 35.4734761,-83.924895 35.473884,-83.9209182 35.4734983,-83.919564 35.473367,-83.916801 35.473612,-83.911773 35.476028,-83.909265 35.479714,-83.90804 35.484397,-83.905612 35.48906,-83.901527 35.491026,-83.900338 35.493095,-83.9002 35.494191,-83.901403 35.495278,-83.901381 35.496553,-83.895669 35.501868,-83.893031 35.502253,-83.892074 35.503089,-83.884262 35.512754,-83.882563 35.517182,-83.880074 35.518745,-83.87263 35.521145,-83.866413 35.52091,-83.859261 35.521851,-83.853898 35.521059,-83.848502 35.519259,-83.840203 35.52156,-83.831895 35.524766,-83.827428 35.524653,-83.82559 35.523829,-83.809798 35.53431,-83.808713 35.536415,-83.802434 35.541588,-83.786802 35.5472,-83.780129 35.550387,-83.773092 35.557465,-83.771736 35.562118,-83.764606 35.561538,-83.759675 35.562492,-83.756917 35.563604,-83.749894 35.561146,-83.735669 35.565455,-83.732947 35.563149,-83.723459 35.561874,-83.720787 35.563347,-83.707199 35.568533,-83.703846 35.568476,-83.702099 35.567634,-83.700663 35.567621,-83.697827 35.568352,-83.684154 35.568848,-83.676268 35.570289,-83.673093 35.568974,-83.666272 35.569389,-83.6635027 35.5692046,-83.660925 35.568207,-83.657933 35.569211,-83.653159 35.568309,-83.645481 35.565825,-83.640498 35.566075,-83.637182 35.567096,-83.635832 35.568169,-83.632358 35.569093,-83.629734 35.567889,-83.615312 35.574026,-83.608889 35.579451,-83.604806 35.57934,-83.601854 35.578228,-83.59427 35.572912,-83.587827 35.566963,-83.58714 35.564017,-83.58559 35.562941,-83.582 35.562684,-83.576345 35.564019,-83.572424 35.565518,-83.56609 35.565993,-83.559264 35.564796,-83.552167 35.564346,-83.5425575 35.565495,-83.540826 35.565702,-83.534169 35.564668,-83.520469 35.565602,-83.517564 35.562871,-83.498335 35.562981,-83.491647 35.566867,-83.485527 35.568204,-83.480617 35.576633,-83.478523 35.579202,-83.479317 35.582764,-83.479082 35.583316,-83.475367 35.584775,-83.4729099 35.5864024,-83.4728744 35.5864259,-83.472684 35.586552,-83.472668 35.589125,-83.471362 35.590304,-83.462678 35.5926,-83.455722 35.598045,-83.452431 35.602918,-83.447137 35.608664,-83.445802 35.611803,-83.441197 35.611739,-83.4324212 35.6099659,-83.432298 35.609941,-83.4314235 35.6100425,-83.4290855 35.610314,-83.421576 35.611186,-83.420964 35.611596,-83.42037 35.613467,-83.411852 35.61692,-83.406061 35.620185,-83.403569 35.621313,-83.396626 35.62272,-83.392652 35.625095,-83.388602 35.632352,-83.388722 35.633584,-83.380251 35.634705,-83.377984 35.634496,-83.376785 35.636638,-83.373712 35.638935,-83.372174 35.63931,-83.370369 35.638204,-83.368162 35.638202,-83.366941 35.638728,-83.358209 35.647277,-83.356202 35.650019,-83.355367 35.652338,-83.355537 35.654632,-83.353776 35.657478,-83.35156 35.659858,-83.349255 35.660854,-83.347262 35.660474,-83.337683 35.663074,-83.334965 35.665471,-83.321101 35.662815,-83.317905 35.659015,-83.312757 35.654809,-83.31049 35.654452,-83.302279 35.656064,-83.297154 35.65775,-83.293676 35.661919,-83.291075 35.667131,-83.290682 35.672638,-83.289165 35.674509,-83.281178 35.677802,-83.27548 35.679463,-83.271378 35.681476,-83.269277 35.6854032,-83.26539 35.6875349,-83.2612521 35.6891649,-83.2610426 35.6893493,-83.2583106 35.6917535,-83.2581174 35.6919235,-83.2565682 35.6944797,-83.2557714 35.6957943,-83.2553359 35.697588,-83.255126 35.701493,-83.2561111 35.7039609,-83.2552746 35.706575,-83.255108 35.7070957,-83.2542303 35.7094781,-83.2544811 35.712362,-83.255489 35.714974,-83.255351 35.71623,-83.251247 35.719916,-83.243501 35.722533,-83.242132 35.723638,-83.240669 35.72676,-83.232042 35.726098,-83.222627 35.726138,-83.219981 35.726601,-83.216972 35.725752,-83.214501 35.724434,-83.203752 35.726553,-83.200126 35.725331,-83.198267 35.725494,-83.18837 35.729798,-83.185685 35.72989,-83.182097 35.735492,-83.180836 35.738882,-83.177499 35.743913,-83.171867 35.745978,-83.170173 35.746107,-83.16477 35.754618,-83.165427 35.7587,-83.164909 35.759965,-83.161537 35.763363,-83.159208 35.764892,-83.15408 35.76428,-83.14808 35.764295,-83.14697 35.765124,-83.127707 35.768093,-83.120183 35.766234,-83.113662 35.770211,-83.110491 35.770913,-83.104805 35.77348,-83.104584 35.77423,-83.10232 35.775071,-83.100233 35.774745,-83.0993954 35.7751213,-83.0990808 35.7752563,-83.0980481 35.7756998,-83.0979213 35.7757542,-83.097193 35.776067,-83.086054 35.783627,-83.085205 35.785794,-83.078732 35.789472,-83.07403 35.790016,-83.072221 35.78831,-83.063975 35.786643,-83.061507 35.786774,-83.05834 35.788241,-83.052677 35.789548,-83.04853 35.787706,-83.046307 35.785853,-83.044108 35.785347,-83.042666 35.785407,-83.03951 35.786777,-83.036209 35.787405,-83.012377 35.779818,-83.006067 35.778404,-83.001473 35.773752,-82.995803 35.773128,-82.992053 35.773948,-82.98397 35.77801,-82.978414 35.78261,-82.974463 35.78679,-82.969648 35.789663,-82.964088 35.78998,-82.9631572 35.7913525,-82.962206 35.792755,-82.962842 35.795126,-82.961724 35.800491,-82.95895 35.803323,-82.956127 35.807874,-82.955751 35.809802,-82.952026 35.816183,-82.9457433 35.8243647,-82.945515 35.824662,-82.94383 35.825638,-82.9374367 35.8273199,-82.933221 35.832915,-82.9318585 35.8363513,-82.9281935 35.8382607,-82.927569 35.838586,-82.9262869 35.8387952,-82.9233584 35.8392732,-82.9226277 35.8398212,-82.9201709 35.8416638,-82.9199353 35.8423707,-82.9191084 35.8448514,-82.920974 35.851073,-82.919374 35.8605234,-82.9183115 35.8639765,-82.9164521 35.8661015,-82.901301 35.872593,-82.8997176 35.8746016,-82.8991863 35.8775235,-82.8997176 35.8799142,-82.9002701 35.8809087,-82.9010457 35.8823048,-82.9039676 35.8854923,-82.903702 35.8876174,-82.9032119 35.8883176,-82.902756 35.8889688,-82.9018426 35.8902736,-82.9018426 35.89118,-82.9018426 35.8929299,-82.902142 35.8933824,-82.904543 35.897011,-82.906917 35.907397,-82.9109842 35.9136549,-82.9116708 35.9147114,-82.9117035 35.9155608,-82.9117474 35.916701,-82.9117639 35.9171299,-82.9123373 35.9177234,-82.9124386 35.9179616,-82.9123903 35.9181528,-82.9118359 35.9190047,-82.9118735 35.9199819,-82.9119365 35.9216177,-82.9116267 35.9240961,-82.9114052 35.9258677,-82.9106083 35.9269302,-82.9085902 35.9270564,-82.9063583 35.9271958,-82.9034364 35.928524,-82.9023739 35.9298521,-82.901577 35.9314459,-82.9017047 35.9373322,-82.901713 35.937713,-82.8990217 35.9449033,-82.896947 35.944624,-82.892659 35.945182,-82.883933 35.949192,-82.874159 35.952698,-82.870666 35.95199,-82.869315 35.950565,-82.860724 35.94743,-82.852554 35.949089,-82.849849 35.947772,-82.841259 35.941721,-82.839994 35.940166,-82.833268 35.934993,-82.830112 35.932972,-82.828933 35.932932,-82.826045 35.929721,-82.82257 35.922531,-82.821861 35.921839,-82.81613 35.923986,-82.811067 35.926801,-82.809038 35.927241,-82.804997 35.927168,-82.802892 35.929013,-82.802769 35.930129,-82.805771 35.935316,-82.806174 35.936908,-82.805851 35.937938,-82.800431 35.944155,-82.7885453 35.9514958,-82.7884736 35.9515401,-82.7876528 35.952047,-82.7876263 35.9520633,-82.787465 35.952163,-82.785191 35.959231,-82.785356 35.96253,-82.784536 35.963905,-82.783085 35.964982,-82.7813007 35.9656276,-82.777751 35.966912,-82.774905 35.971978,-82.776434 35.973886,-82.778625 35.974792,-82.780319 35.974365,-82.781809 35.974562,-82.785558 35.977795,-82.785267 35.987927,-82.779397 35.992511,-82.778589 35.997001,-82.777283 35.998811,-82.776001 36.000103,-82.765365 36.003003,-82.759165 36.004203,-82.754465 36.004304,-82.750065 36.006004,-82.731865 36.017604,-82.727865 36.018504,-82.725065 36.018204,-82.7168781 36.0222096,-82.7165663 36.0224126,-82.7162843 36.0226646,-82.7160664 36.022945,-82.7158098 36.0230912,-82.7157396 36.0232172,-82.7156132 36.0235181,-82.7156611 36.024075,-82.7156572 36.02425,-82.715603 36.0252914,-82.7157568 36.0266013,-82.7157597 36.0269448,-82.7156587 36.0278487,-82.715535 36.0281691,-82.7153564 36.0283764,-82.7151675 36.0285777,-82.7148989 36.0287043,-82.7146154 36.0287784,-82.7142597 36.0288146,-82.7136955 36.0288903,-82.7121755 36.0291864,-82.707465 36.030104,-82.703165 36.032404,-82.701065 36.034404,-82.688865 36.038604,-82.685565 36.042004,-82.684765 36.045004,-82.683565 36.046104,-82.672965 36.050405,-82.668365 36.052905,-82.662665 36.055005,-82.657249 36.056636,-82.654815 36.056225,-82.650165 36.057805,-82.643565 36.062805,-82.637165 36.065805,-82.6323563 36.0657069,-82.632265 36.065705,-82.628365 36.062105,-82.6189964 36.0563105,-82.6188408 36.0562143,-82.618664 36.056105,-82.6185399 36.0559366,-82.617264 36.054205,-82.618064 36.051205,-82.618164 36.047005,-82.613563 36.046406,-82.609663 36.044906,-82.606163 36.041006,-82.602877 36.039833,-82.6007411 36.0374222,-82.6005888 36.0371684,-82.598785 36.034162,-82.5961769 36.0318799,-82.5948728 36.0295978,-82.5949242 36.0293153,-82.5955249 36.0260117,-82.600089 36.0217735,-82.6043272 36.0181874,-82.6089704 36.0108041,-82.6092223 36.0104036,-82.611862 36.006206,-82.613862 36.004706,-82.614362 36.003506,-82.615062 36.000306,-82.613028 35.994,-82.612604 35.993488,-82.606944 35.99217,-82.604239 35.987319,-82.60674 35.984446,-82.610885 35.974442,-82.611602 35.971418,-82.610889 35.967409,-82.609387 35.9667435,-82.607761 35.966023,-82.60037 35.964626,-82.59486 35.965347,-82.591977 35.966385,-82.581003 35.965557,-82.577719 35.964196,-82.576678 35.959255,-82.57517 35.958384,-82.567503 35.955552,-82.557874 35.953901,-82.553192 35.960627,-82.549682 35.964275,-82.542463 35.967994,-82.539273 35.969115,-82.534763 35.969887,-82.531292 35.972188,-82.522702 35.973436,-82.52066 35.974633,-82.516444 35.975958,-82.5163074 35.9759476,-82.512598 35.975664,-82.507068 35.977475,-82.5039058 35.9789058,-82.500206 35.982561,-82.487451 35.991557,-82.487411 35.991634,-82.4858348 35.9923347,-82.484678 35.992849,-82.483666 35.993866,-82.483498 35.996284,-82.482292 35.997823,-82.47419 36.000108,-82.464558 36.006508,-82.4617083 36.0074586,-82.460658 36.007809,-82.4591974 36.0099656,-82.4591735 36.0100009,-82.4166296 36.0728196,-82.4096173 36.0831739,-82.409458 36.083409,-82.404458 36.087609,-82.389958 36.096909,-82.380458 36.099309,-82.378758 36.102809,-82.375558 36.105609,-82.371383 36.106388,-82.366566 36.10765,-82.360919 36.110614,-82.360357 36.111609,-82.355157 36.115609,-82.349957 36.117109,-82.3485035 36.1159271,-82.346857 36.115209,-82.336756 36.114909,-82.332289 36.116935,-82.329177 36.117427,-82.325169 36.119363,-82.321448 36.119551,-82.318156 36.12091,-82.308655 36.12651,-82.307255 36.12851,-82.3030651 36.1311763,-82.302855 36.13131,-82.297655 36.13351,-82.2975095 36.133549,-82.289455 36.13571,-82.2891847 36.1356289,-82.288637 36.1354646,-82.288455 36.13541,-82.2864617 36.1337861,-82.280354 36.12881,-82.2799121 36.128732,-82.2791789 36.1286026,-82.278654 36.12851,-82.278242 36.1285906,-82.274054 36.12941,-82.2725164 36.1285172,-82.270954 36.12761,-82.2687505 36.1270398,-82.2656904 36.1276135,-82.2656211 36.1276876,-82.263354 36.13011,-82.260353 36.13371,-82.256319 36.1339249,-82.253253 36.13371,-82.251853 36.13221,-82.2475213 36.1308649,-82.2463005 36.1316278,-82.2454794 36.1321411,-82.2444613 36.1327774,-82.243353 36.134311,-82.241553 36.137111,-82.237737 36.139189,-82.2364493 36.1399375,-82.2354961 36.1407503,-82.234807 36.14172,-82.2330923 36.1430093,-82.228288 36.146622,-82.224852 36.150011,-82.2232321 36.1547716,-82.222052 36.156911,-82.2184508 36.1578316,-82.213852 36.159112,-82.2118567 36.1590353,-82.2114106 36.1590181,-82.211251 36.159012,-82.2111702 36.1589874,-82.2048718 36.1570666,-82.2018117 36.1549628,-82.199251 36.152713,-82.19535 36.150013,-82.19195 36.148813,-82.1878502 36.1478864,-82.18475 36.145414,-82.18365 36.144414,-82.182549 36.143714,-82.1788613 36.1432963,-82.1756099 36.1438701,-82.173849 36.145314,-82.172149 36.146414,-82.169249 36.146614,-82.1608834 36.1465477,-82.155948 36.148115,-82.1552805 36.1482319,-82.147948 36.149516,-82.144147 36.144216,-82.140847 36.136216,-82.1383324 36.1318892,-82.136547 36.128817,-82.136546 36.123717,-82.137974 36.119576,-82.1344067 36.1131701,-82.1308059 36.1067041,-82.130646 36.106417,-82.1291164 36.1055429,-82.127146 36.104417,-82.1159147 36.1046067,-82.115245 36.104618,-82.1106144 36.1065917,-82.1102498 36.1067471,-82.109145 36.107218,-82.105444 36.108119,-82.101644 36.106219,-82.098544 36.105719,-82.085943 36.10602,-82.0825123 36.1058425,-82.080443 36.1057355,-82.080143 36.10572,-82.079743 36.10652,-82.067142 36.11202,-82.061342 36.113121,-82.056042 36.120721,-82.056042 36.123921,-82.054142 36.126821,-82.048438 36.1260382,-82.043941 36.125421,-82.037941 36.121122,-82.0338513 36.1205256,-82.033141 36.120422,-82.02874 36.124322,-82.02634 36.129222,-82.02664 36.130222,-82.0193129 36.1410034,-82.0165245 36.1451064,-81.9993694 36.1703494,-81.9757376 36.2051225,-81.971195 36.2118066,-81.960101 36.228131,-81.9387739 36.2561831,-81.932994 36.264881,-81.9200661 36.2842551,-81.9181704 36.2870249,-81.908137 36.302013,-81.897701 36.307446,-81.894569 36.307183,-81.887243 36.309193,-81.879382 36.313767,-81.8792438 36.3138667,-81.876182 36.316075,-81.874336 36.31919,-81.863148 36.330209,-81.8573331 36.3347867,-81.853085 36.3365754,-81.8526528 36.3367573,-81.8508892 36.3374999,-81.845638 36.34036,-81.841268 36.343321,-81.833202 36.347339,-81.822493 36.348819,-81.8129045 36.3510659,-81.8125205 36.3513182,-81.808255 36.354121,-81.800812 36.358073,-81.7952687 36.3578489,-81.7918772 36.3547965,-81.7908525 36.3529521,-81.790376 36.3520945,-81.7901814 36.3517442,-81.7877843 36.3490474,-81.7874682 36.3486918,-81.7840767 36.3476744,-81.781318 36.347656,-81.7779721 36.3463178,-81.768977 36.341042,-81.7661018 36.3385173,-81.7623712 36.3388565,-81.7606754 36.3381782,-81.7579622 36.3374999,-81.75442 36.337044,-81.7532786 36.3370981,-81.7507471 36.3372182,-81.747842 36.337356,-81.744461 36.337778,-81.7402013 36.3394766,-81.739498 36.339757,-81.7349 36.3408914,-81.730976 36.341187,-81.725938 36.340364,-81.721015 36.338645,-81.717186 36.336169,-81.7142962 36.3346772,-81.7131945 36.3341084,-81.707438 36.335171,-81.7071884 36.3364242,-81.7068526 36.3372185,-81.705966 36.338496,-81.7053366 36.3397187,-81.7053145 36.3417742,-81.705299 36.341852,-81.7053728 36.3419753,-81.7069376 36.3445907,-81.707785 36.346007,-81.7138728 36.3493701,-81.7182817 36.3503876,-81.7213341 36.3531008,-81.7226907 36.3547965,-81.7237081 36.3585272,-81.7240473 36.3609012,-81.7240473 36.3642927,-81.7260028 36.3687138,-81.7260035 36.3687155,-81.726082 36.368893,-81.731178 36.374062,-81.7328652 36.3765021,-81.732629 36.3776829,-81.7321868 36.3798936,-81.730737 36.382943,-81.7298128 36.3880332,-81.7301977 36.3893805,-81.730607 36.3903018,-81.7315085 36.392103,-81.7321305 36.3927508,-81.733877 36.39457,-81.7379524 36.3971902,-81.7396482 36.4015992,-81.7396482 36.4066864,-81.7382915 36.4107562,-81.734312 36.413342,-81.729924 36.415422,-81.720734 36.422537,-81.717939 36.428762,-81.7169251 36.4331401,-81.7152294 36.4365316,-81.7152294 36.436941,-81.7152294 36.4385665,-81.7155685 36.4412797,-81.7154524 36.4423248,-81.7152294 36.444332,-81.7143188 36.4467603,-81.7142119 36.4470452,-81.714277 36.450978,-81.715082 36.453365,-81.7148902 36.4572197,-81.708247 36.462217,-81.701076 36.464212,-81.699223 36.463959,-81.697975 36.464741,-81.6974305 36.4653891,-81.6953132 36.4679093,-81.695311 36.467912,-81.695297 36.468009,-81.6952412 36.4683941,-81.6952382 36.4684143,-81.694533 36.473283,-81.694829 36.474463,-81.696281 36.475499,-81.697287 36.484738,-81.6962915 36.4896738,-81.695907 36.49158,-81.696835 36.493393,-81.697261 36.496141,-81.698265 36.497221,-81.699928 36.498018,-81.700238 36.500475,-81.699923 36.500865,-81.69797 36.504063,-81.69729 36.504887,-81.697829 36.507544,-81.697744 36.508448,-81.699446 36.511504,-81.699601 36.512883,-81.700093 36.514158,-81.700553 36.51519,-81.702543 36.520317,-81.707573 36.526101,-81.708262 36.532113,-81.707963 36.536209,-81.699962 36.536829,-81.699962 36.539714,-81.697539 36.544359,-81.693844 36.549083,-81.69003 36.552154,-81.6891148 36.5559123,-81.6901323 36.5596429,-81.6902402 36.5598047,-81.6921672 36.5626953,-81.6925063 36.5657476,-81.691945 36.5664821,-81.690236 36.568718,-81.686436 36.567918,-81.6803321 36.5685753,-81.679936 36.568618,-81.678916 36.5693566,-81.677184 36.5706109,-81.677036 36.570718,-81.677041 36.5708109,-81.6771424 36.5726797,-81.677236 36.574406,-81.6790141 36.5788631,-81.679036 36.578918,-81.6794554 36.5814322,-81.680137 36.585518,-81.6776221 36.5880363,-81.6469 36.611918,-81.8266795 36.6146598,-81.922644 36.616213,-81.934144 36.594213,-82.095975 36.594725,-82.096575 36.594729,-82.098375 36.594743,-82.098975 36.594751,-82.09903 36.594748,-82.099195 36.594749,-82.09925 36.594753,-82.099834 36.594754,-82.101492 36.594768,-82.101586 36.594767,-82.102171 36.594762,-82.103285 36.594751,-82.106628 36.59472,-82.107743 36.594711,-82.108328 36.594705,-82.108832 36.594701,-82.110083 36.594666,-82.110693 36.594649,-82.1108563 36.5946477,-82.111054 36.594641,-82.111121 36.59464,-82.111196 36.594639,-82.111284 36.594638,-82.111424 36.594637,-82.1123771 36.594616,-82.112767 36.594615,-82.1127971 36.5946153,-82.113167 36.594608,-82.113194 36.594607,-82.114089 36.594594,-82.114263 36.594592,-82.114337 36.59459,-82.114509 36.594586,-82.114562 36.594586,-82.114638 36.594586,-82.115044 36.594582,-82.116262 36.594573,-82.116669 36.594571,-82.11713 36.594567,-82.117359 36.594566,-82.118514 36.594559,-82.118976 36.594557,-82.120112 36.594551,-82.120992 36.594547,-82.123523 36.594523,-82.12458 36.594514,-82.124653 36.594549,-82.124711 36.594578,-82.124852 36.594647,-82.124895 36.594648,-82.124962 36.594651,-82.125083 36.594656,-82.125446 36.594672,-82.125999 36.594697,-82.127298 36.594755,-82.127731 36.594775,-82.127808 36.594778,-82.127911 36.594777,-82.128451 36.594775,-82.128632 36.594775,-82.128992 36.594773,-82.130075 36.59477,-82.1307271 36.5947669,-82.130893 36.594767,-82.132267 36.594763,-82.132697 36.594762,-82.1327598 36.5947623,-82.132947 36.594761,-82.133611 36.594759,-82.133833 36.594759,-82.134773 36.594756,-82.137597 36.594749,-82.138535 36.594744,-82.138553 36.594747,-82.1386 36.594747,-82.138885 36.594745,-82.138951 36.594744,-82.139145 36.594744,-82.139724 36.594742,-82.139917 36.594742,-82.140523 36.594739,-82.142341 36.594734,-82.142948 36.594733,-82.142967 36.594733,-82.143649 36.59473,-82.145464 36.594725,-82.14607 36.594724,-82.146111 36.594724,-82.146234 36.594724,-82.146279 36.594724,-82.147155 36.594721,-82.148886 36.594724,-82.14897 36.594729,-82.149313 36.594754,-82.149754 36.594754,-82.150102 36.594728,-82.150169 36.594724,-82.150506 36.59471,-82.15057 36.594709,-82.150656 36.594708,-82.150917 36.594706,-82.150979 36.594706,-82.1510035 36.5947015,-82.151045 36.5947,-82.151169 36.594692,-82.151211 36.59469,-82.15134 36.594693,-82.151731 36.594703,-82.151861 36.594707,-82.151926 36.594709,-82.152124 36.594715,-82.15219 36.594717,-82.152479 36.594725,-82.153346 36.594751,-82.153564 36.594758,-82.153614 36.594744,-82.221846 36.595863,-82.221938 36.595925,-82.222027 36.595963,-82.222067 36.59597,-82.222289 36.596012,-82.222615 36.59603,-82.22303 36.596008,-82.22335 36.595986,-82.223506 36.595983,-82.223723 36.595951,-82.223837 36.595903,-82.223931 36.595826,-82.224032 36.595744,-82.22405 36.595727,-82.225874 36.595744,-82.225985 36.595838,-82.226045 36.595861,-82.226124 36.595884,-82.226255 36.595896,-82.226348 36.59589,-82.226562 36.595884,-82.2266652 36.595874,-82.226747 36.595855,-82.22682 36.595822,-82.226842 36.59581,-82.226865 36.595802,-82.226885 36.595788,-82.226947 36.595746,-82.226968 36.595733,-82.234442 36.595672,-82.242063 36.595659,-82.243382 36.595651,-82.2634298 36.5957226,-82.2724756 36.5957176,-82.2929814 36.5957062,-82.296995 36.595704,-82.3867619 36.5950568,-82.391007 36.5950261,-82.4165724 36.5948418,-82.4639057 36.5945005,-82.465051 36.5944923,-82.4663336 36.594483,-82.4663461 36.5944829,-82.466613 36.594481,-82.4673563 36.5945493,-82.478668 36.595588,-82.4863851 36.5957987,-82.4867752 36.5958094,-82.48693 36.595822,-82.487238 36.595822,-82.5170735 36.5954011,-82.545474 36.5950004,-82.545583 36.594999,-82.549173 36.5949482,-82.554294 36.594876,-82.559774 36.5948,-82.560774 36.5948,-82.561074 36.5948,-82.5615519 36.594793,-82.5616682 36.5947913,-82.5660236 36.5947279,-82.5664416 36.5947218,-82.5711343 36.5946534,-82.5720782 36.5946396,-82.5723744 36.5946353,-82.5881143 36.5944059,-82.5936085 36.5943259,-82.609176 36.594099,-82.6094468 36.5940975,-82.6505937 36.5938641,-82.6539528 36.593845,-82.679879 36.593698,-82.68828 36.593698,-82.69578 36.593698,-82.6993806 36.5936997,-82.7203676 36.5937095,-82.7796518 36.5937372,-82.830433 36.593761,-82.888013 36.593461,-82.9850328 36.5937291,-83.02725 36.593847,-83.028357 36.593893,-83.1016648 36.5938711,-83.1746351 36.5938492,-83.225515 36.593834,-83.248933 36.593827,-83.249899 36.593898,-83.250304 36.593935,-83.252629 36.593925,-83.261099 36.593887,-83.2763 36.598187,-83.374904 36.597386,-83.472108 36.597284,-83.5444304 36.5973694,-83.5469994 36.5973724,-83.55681 36.597384,-83.5853777 36.5976779,-83.5949515 36.5977763,-83.622066 36.5980553,-83.622624 36.598061,-83.6374092 36.5993108,-83.6419287 36.5996928,-83.6422266 36.599718,-83.645586 36.600002,-83.6497112 36.6001301,-83.660403 36.600462,-83.6701414 36.6007575,-83.6750166 36.6008122,-83.675413 36.600814,-83.675614 36.598582,-83.6763587 36.597589,-83.6764249 36.5975008,-83.6766638 36.5971823,-83.677114 36.596582,-83.679514 36.594082,-83.683014 36.592182,-83.687514 36.587182,-83.688814 36.584382,-83.690714 36.582581,-83.69085 36.5825828,-83.6908506 36.5825828,-83.789017 36.583881,-83.894421 36.586481,-83.9297946 36.5877579,-83.987842 36.5896,-84.0085275 36.5899681,-84.0214825 36.5900367,-84.1047647 36.5911178,-84.1226438 36.5913499,-84.1262106 36.5913962,-84.127503 36.591413,-84.1499651 36.5915858,-84.1911792 36.5919029,-84.1976179 36.5919524,-84.2266139 36.5921755,-84.2291816 36.592181,-84.261333 36.591981,-84.271176 36.591882,-84.4182918 36.5954789,-84.435107 36.59589,-84.4361348 36.5959151,-84.4392044 36.5959902,-84.4405039 36.596022,-84.442787 36.596077,-84.4502704 36.596157,-84.4504881 36.5961593,-84.4506128 36.5961606,-84.478788 36.596455,-84.499938 36.596678,-84.5208544 36.5964838,-84.5208876 36.5964835,-84.543138 36.596277,-84.5619721 36.5970363,-84.624939 36.599575,-84.638364 36.5998928,-84.642313 36.5999863,-84.7782689 36.6032046,-84.785341 36.603372,-84.803744 36.604265,-84.843091 36.605127,-84.859759 36.606428,-84.859738 36.606495,-84.943948 36.612569,-84.9750495 36.6155686,-84.9885655 36.616868,-85.024627 36.619354,-85.0496232 36.6203892,-85.0862536 36.6219063,-85.086415 36.621913,-85.096128 36.622483,-85.1701819 36.6247327,-85.195372 36.625498,-85.2083423 36.6256604,-85.2122141 36.6257088,-85.2758831 36.6264296,-85.290627 36.62645,-85.296073 36.625824,-85.300402 36.624437,-85.324654 36.62455,-85.334124 36.622951,-85.4295094 36.6189776,-85.430123 36.618952,-85.4363327 36.6185299,-85.488353 36.614994,-85.5021382 36.6151541,-85.551483 36.615727,-85.552017 36.615782,-85.5869641 36.6164419,-85.5882448 36.6164661,-85.6658432 36.6179314,-85.677789 36.618157,-85.6940106 36.6188386,-85.7003703 36.6191058,-85.731862 36.620429,-85.7527998 36.6209515,-85.7876033 36.621846,-85.80149 36.622418,-85.832172 36.622046,-85.873857 36.623642,-85.904185 36.6252192,-85.92066 36.6260761,-85.959981 36.628121,-85.9718739 36.628488,-85.9738199 36.6286269,-85.9767255 36.6286377,-85.9875467 36.6289716,-86.0060288 36.6295419,-86.03277 36.630367,-86.033139 36.630413,-86.038366 36.630804,-86.080666 36.63394,-86.081944 36.633848,-86.0943199 36.6344383,-86.1143344 36.6353929,-86.1284459 36.6360659,-86.197573 36.639363,-86.204859 36.639741,-86.2072346 36.6399086,-86.216183 36.640527,-86.21641 36.640595,-86.219081 36.640824,-86.222151 36.640891,-86.2644166 36.6435413,-86.293357 36.645356,-86.331847 36.6486742,-86.333051 36.648778,-86.3402318 36.6490724,-86.359073 36.649845,-86.373784 36.650126,-86.374991 36.649803,-86.4011282 36.6503727,-86.4112441 36.6505932,-86.468497 36.651841,-86.47219 36.651763,-86.473413 36.651676,-86.473497 36.651671,-86.507771 36.652445,-86.5383681 36.642325,-86.543777 36.640536,-86.543388 36.64389,-86.550054 36.644817,-86.551292 36.637985,-86.56388 36.6335536,-86.5734367 36.6405061,-86.5741513 36.6410259,-86.5766839 36.6428683,-86.5783065 36.6440486,-86.5814984 36.6463705,-86.5865356 36.6500345,-86.589906 36.652486,-86.5911982 36.6524558,-86.5939784 36.6523909,-86.6048985 36.6521358,-86.6790122 36.6502366,-86.6991381 36.6497183,-86.713786 36.649341,-86.75892 36.649018,-86.7628886 36.6489353,-86.7875326 36.6482931,-86.813037 36.647647,-86.816186 36.647722,-86.818405 36.647639,-86.833155 36.64721,-86.843604 36.6470487,-86.854268 36.646884,-86.906023 36.646302,-86.906583 36.646255,-86.9199227 36.6459619,-86.9873988 36.6444791,-87.0002907 36.6441958,-87.011522 36.643949,-87.0414941 36.6435043,-87.0603163 36.643225,-87.1151882 36.642414,-87.2037923 36.642016,-87.2307422 36.641895,-87.2312492 36.641888,-87.2478672 36.641841,-87.2763202 36.6418478,-87.2956349 36.6418443,-87.2956754 36.6412947,-87.3212676 36.6414469,-87.321272 36.6417084,-87.3356972 36.6415429,-87.3389122 36.64153,-87.3391273 36.6415291,-87.3393071 36.6415284,-87.3438808 36.64151,-87.3475458 36.64144,-87.3566317 36.6413863,-87.398139 36.6411407,-87.4140588 36.641047,-87.4247588 36.641047,-87.4260819 36.6410125,-87.4362677 36.6409036,-87.4367349 36.6408957,-87.4757524 36.6403817,-87.5628018 36.639113,-87.5646778 36.639113,-87.6369086 36.6380918,-87.6408998 36.638036,-87.642279 36.6380109,-87.6654187 36.63759,-87.6938505 36.6370728,-87.6978305 36.6370049,-87.744768 36.636151,-87.797039 36.6347511,-87.8535427 36.6350732,-87.8504528 36.6650968,-87.901777 36.6679384,-87.9042209 36.6680737,-87.9048052 36.668106,-87.9106505 36.6684296,-87.9113858 36.6684703,-87.9121239 36.6685112,-87.913325 36.6686138,-87.9147745 36.6687376,-87.9178028 36.6689963,-88.011792 36.677025,-88.044772 36.677983,-88.070532 36.678118,-88.068208 36.659747,-88.064401 36.650854,-88.05858 36.643315,-88.057042 36.64054,-88.055604 36.63571,-88.055738 36.630475,-88.045127 36.602939,-88.041196 36.584123,-88.039625 36.572783,-88.035625 36.561736,-88.033802 36.551733,-88.032489 36.540662,-88.034132 36.53112,-88.035854 36.525912,-88.03727 36.523783,-88.03783 36.521015,-88.037329 36.51783,-88.037822 36.51385,-88.039481 36.510408,-88.045304 36.504081,-88.050466 36.500053,-88.054573 36.498032,-88.057053 36.496719,-88.062775 36.49678,-88.085915 36.497021,-88.179283 36.500053,-88.48921 36.501068,-88.51192 36.501457,-88.51227 36.501506,-88.516427 36.50143,-88.545192 36.501814,-88.577283 36.50194,-88.6235214 36.5021071,-88.661133 36.502243,-88.715255 36.502662,-88.747523 36.502834,-88.799594 36.502757,-88.8166353 36.5029833,-88.8301027 36.5029372,-88.834626 36.502914,-88.85526 36.5026742,-88.8591103 36.502629,-88.8704351 36.5024961,-88.8717668 36.5024805,-88.874725 36.502446,-88.8761046 36.5024428,-88.8850115 36.5023946,-88.8945536 36.5023591,-88.8986907 36.5023375,-88.8996346 36.502342,-88.9003051 36.5023218,-88.9179951 36.5023287,-88.9198418 36.5022956,-88.9198879 36.5022893,-88.9202048 36.5022827,-88.964471 36.502191,-89.000063 36.502633,-89.006825 36.502684,-89.010439 36.50271,-89.034649 36.502964,-89.058871 36.503157,-89.072118 36.503249,-89.090146 36.503392,-89.117537 36.503603,-89.119805 36.503647,-89.1602573 36.5044622,-89.163224 36.504522,-89.163429 36.504526,-89.211409 36.50563,-89.2149638 36.5056763,-89.215864 36.505688,-89.235042 36.505934,-89.279091 36.506511,-89.282298 36.506782,-89.300284 36.507147,-89.3479508 36.5030792,-89.356593 36.502195,-89.380085 36.500416,-89.381792 36.500062,-89.391044 36.499079,-89.403913 36.499141,-89.417293 36.499033,-89.41977 36.493896,-89.422942 36.489381,-89.429311 36.481875,-89.436763 36.474432,-89.448468 36.46442,-89.453081 36.461285,-89.460436 36.45814,-89.464153 36.457189,-89.471718 36.457001,-89.476532 36.457846,-89.486215 36.46162,-89.49067 36.465528,-89.493198 36.470124,-89.494074 36.473225,-89.494248 36.475972,-89.493495 36.4787,-89.48671 36.494954,-89.4851997 36.4974534,-89.4884968 36.4975516,-89.492876 36.497682,-89.495613 36.497723,-89.4987633 36.4977531,-89.5062176 36.4978178,-89.5181915 36.4979217,-89.5281901 36.4980084,-89.5336842 36.4980561,-89.5391221 36.4981033,-89.534524 36.491432,-89.522674 36.481305,-89.520642 36.478668,-89.519501 36.475419,-89.51972 36.467002,-89.521021 36.461934,-89.523427 36.456572,-89.52519 36.453991,-89.527274 36.451545,-89.540868 36.441559,-89.543406 36.43877,-89.545061 36.434915,-89.545503 36.4307,-89.545255 36.427079,-89.544221 36.423684,-89.542337 36.420103,-89.525293 36.400446,-89.513956 36.384891,-89.51038 36.378356,-89.509558 36.375065,-89.5095948 36.374742,-89.509722 36.373626,-89.5112796 36.3674384,-89.5112888 36.367402,-89.513178 36.359897,-89.5162867 36.3538649,-89.519 36.3486,-89.522695 36.344789,-89.527029 36.341679,-89.531822 36.339246,-89.538079 36.337496,-89.545006 36.336809,-89.560439 36.337746,-89.581636 36.342357,-89.600544 36.342985,-89.605668 36.342234,-89.610689 36.340442,-89.615841 36.336085,-89.6198 36.329546,-89.620255 36.323006,-89.619242 36.320726,-89.611819 36.309088,-89.58982 36.296814,-89.584337 36.29334,-89.578492 36.288317,-89.567698 36.2828987,-89.554289 36.277751,-89.549219 36.27875,-89.546577 36.280439,-89.544797 36.280458,-89.5444719 36.2802688,-89.539487 36.277368,-89.537675 36.275279,-89.5373935 36.2746576,-89.5372577 36.2743576,-89.535529 36.270541,-89.534507 36.261802,-89.5347414 36.2527165,-89.534745 36.252576,-89.5360776 36.2514601,-89.5390336 36.2489846,-89.539229 36.248821,-89.541621 36.247891,-89.544743 36.247484,-89.5451692 36.2475565,-89.5473642 36.2479299,-89.548952 36.2482,-89.5497319 36.2485621,-89.553563 36.250341,-89.557991 36.251037,-89.562206 36.250909,-89.564997 36.250067,-89.573928 36.243843,-89.5763106 36.2428013,-89.577544 36.242262,-89.587326 36.239484,-89.5886855 36.2393595,-89.602374 36.238106,-89.60651 36.238328,-89.6085412 36.2387412,-89.609781 36.2389935,-89.611145 36.239271,-89.624416 36.243305,-89.63679 36.248079,-89.642182 36.249486,-89.6444577 36.2497515,-89.652518 36.250692,-89.6708783 36.2487912,-89.678046 36.248284,-89.6821667 36.2485651,-89.686229 36.249507,-89.691308 36.252079,-89.695235 36.252766,-89.698568 36.250591,-89.699817 36.248384,-89.703511 36.243412,-89.705328 36.239898,-89.705545 36.238136,-89.70525 36.236568,-89.704459 36.235468,-89.699677 36.230821,-89.69263 36.224959,-89.6824215 36.2178371,-89.664144 36.20652,-89.654876 36.20153,-89.64479 36.194101,-89.636893 36.188951,-89.6294764 36.1846542,-89.623804 36.183128,-89.618228 36.179966,-89.607004 36.171179,-89.6014872 36.1652232,-89.600871 36.164558,-89.6001069 36.1634839,-89.5958349 36.1574784,-89.594397 36.155457,-89.5941771 36.1549213,-89.592206 36.15012,-89.591605 36.144096,-89.5920455 36.1365983,-89.592102 36.135637,-89.59307 36.129699,-89.594 36.12719,-89.598946 36.121778,-89.601936 36.11947,-89.6129331 36.1147567,-89.615128 36.113816,-89.625078 36.108131,-89.628305 36.106853,-89.64302 36.10362,-89.657709 36.099128,-89.666598 36.095802,-89.672463 36.091837,-89.678821 36.084636,-89.680029 36.082494,-89.681946 36.072336,-89.684439 36.051719,-89.6885039 36.048742,-89.6951782 36.0442706,-89.6988967 36.042112,-89.7017094 36.0391823,-89.7031396 36.0378331,-89.7049035 36.036985,-89.7092895 36.0343249,-89.710958 36.0323973,-89.7122929 36.0297757,-89.7157254 36.0209078,-89.7168013 36.0190092,-89.7181838 36.0181609,-89.7205198 36.0175439,-89.7229988 36.0168884,-89.7266697 36.0154616,-89.7291487 36.0140734,-89.7307219 36.0123381,-89.731723 36.0109884,-89.7325335 36.009176,-89.7333916 36.0074406,-89.7338207 36.0040853,-89.733095 36.000608,-89.731218 35.996879,-89.728442 35.993568,-89.7199324 35.9866255,-89.7193284 35.985971,-89.7190226 35.9850844,-89.7189029 35.9839944,-89.71997 35.97462,-89.719679 35.970939,-89.718796 35.968283,-89.714565 35.963034,-89.710227 35.959826,-89.699871 35.954063,-89.686924 35.947716,-89.676621 35.940539,-89.671117 35.935795,-89.656147 35.92581,-89.652279 35.921462,-89.65034 35.917795,-89.646711 35.908008,-89.644838 35.904351,-89.6433443 35.9015458,-89.6426563 35.899296,-89.6422486 35.8962616,-89.6422996 35.8943213,-89.6429111 35.891968,-89.6447713 35.8884585,-89.6477526 35.884887,-89.6508868 35.8823064,-89.658251 35.8781565,-89.6618948 35.8762363,-89.6654368 35.875493,-89.6676537 35.8752659,-89.6701254 35.875493,-89.6729028 35.8762157,-89.6787636 35.8788998,-89.6814901 35.8809231,-89.6849301 35.8835657,-89.6916572 35.8906881,-89.6938486 35.8925253,-89.6964029 35.8940267,-89.6986371 35.8948879,-89.7090696 35.8986975,-89.712439 35.9001424,-89.7172679 35.9032804,-89.7205832 35.9048128,-89.7285292 35.9078922,-89.7324932 35.9090451,-89.735286 35.9095705,-89.7375226 35.9097399,-89.7392163 35.9097107,-89.7413514 35.909324,-89.7444055 35.9080397,-89.7507411 35.9041046,-89.7584107 35.8985599,-89.7629512 35.8945021,-89.765689 35.891299,-89.768743 35.886663,-89.771726 35.879724,-89.772855 35.876244,-89.773564 35.871697,-89.773294 35.867426,-89.772467 35.865098,-89.769413 35.861558,-89.764343 35.858313,-89.749424 35.852955,-89.729517 35.847632,-89.709261 35.838911,-89.704351 35.835726,-89.702883 35.834153,-89.701407 35.830985,-89.701045 35.828227,-89.70175 35.824238,-89.703875 35.820281,-89.7052677 35.8185148,-89.7080159 35.8159269,-89.7141033 35.8111822,-89.7178266 35.8085701,-89.7282826 35.8036068,-89.7299528 35.8032512,-89.7312235 35.8034669,-89.7330261 35.8040421,-89.7347695 35.8050007,-89.7362766 35.8060313,-89.7372518 35.8061271,-89.7409456 35.8056957,-89.743025 35.805817,-89.757874 35.810415,-89.765442 35.811214,-89.765457 35.809513,-89.781793 35.805084,-89.796324 35.792807,-89.799331 35.788503,-89.797053 35.782648,-89.797231 35.780117,-89.799249 35.775439,-89.80928 35.764379,-89.812891 35.761154,-89.814456 35.759941,-89.821216 35.756716,-89.824923 35.755715,-89.832895 35.754905,-89.846343 35.755732,-89.857707 35.750077,-89.863874 35.747592,-89.872845 35.741299,-89.877256 35.741369,-89.883535 35.744984,-89.888163 35.750077,-89.905538 35.759063,-89.909996 35.759396,-89.913132 35.757302,-89.9155132 35.7548882,-89.950278 35.738493,-89.953983 35.73616,-89.956254 35.733386,-89.958687 35.727706,-89.958882 35.723834,-89.956933 35.711677,-89.956589 35.695486,-89.955753 35.690621,-89.953303 35.686418,-89.950161 35.682433,-89.9427 35.675121,-89.937383 35.665711,-89.931036 35.660044,-89.922749 35.655293,-89.915427 35.652782,-89.906147 35.651145,-89.898916 35.650904,-89.89051 35.652408,-89.886979 35.653637,-89.884932 35.655107,-89.882893 35.657463,-89.878534 35.66482,-89.877158 35.666136,-89.872078 35.668487,-89.864782 35.670385,-89.861277 35.670064,-89.858935 35.66906,-89.85351 35.663034,-89.851176 35.657432,-89.850863 35.650208,-89.851825 35.644262,-89.85389 35.638261,-89.856619 35.634444,-89.863875 35.630788,-89.876548 35.626653,-89.8772518 35.6262134,-89.8846261 35.6216068,-89.8925472 35.616355,-89.894346 35.615535,-89.896999 35.614882,-89.899789 35.615061,-89.906029 35.616145,-89.910687 35.617536,-89.912172 35.617055,-89.919619 35.612236,-89.9325 35.607865,-89.945405 35.601611,-89.951147 35.597491,-89.954145 35.594264,-89.956749 35.590511,-89.957896 35.587261,-89.957924 35.585499,-89.95669 35.581426,-89.954196 35.57605,-89.946911 35.56358,-89.944754 35.560308,-89.941393 35.556555,-89.929101 35.551545,-89.924145 35.550561,-89.917424 35.550308,-89.914177 35.549713,-89.910789 35.547515,-89.9100427 35.5445241,-89.9103603 35.5433181,-89.9114041 35.5409419,-89.9129422 35.5378737,-89.9133961 35.5368471,-89.9134514 35.5360385,-89.912733 35.5356488,-89.9107776 35.5361359,-89.909544 35.5367326,-89.905582 35.536774,-89.904392 35.535701,-89.9039835 35.5347439,-89.9040002 35.5333093,-89.9045884 35.5316487,-89.9074458 35.5235807,-89.90766 35.522944,-89.909022 35.520548,-89.911931 35.51741,-89.9154 35.515119,-89.919331 35.51387,-89.923161 35.514428,-89.933614 35.518538,-89.945026 35.519388,-89.9476554 35.5200178,-89.951248 35.521866,-89.9522013 35.522563,-89.956347 35.525594,-89.957715 35.527192,-89.957739 35.530125,-89.95578 35.533214,-89.955641 35.534518,-89.956706 35.539369,-89.958498 35.541703,-89.97631 35.553872,-89.989363 35.560043,-89.992975 35.560774,-89.998996 35.56116,-90.008293 35.560065,-90.011262 35.559105,-90.017312 35.555996,-90.023903 35.556336,-90.02862 35.555249,-90.032938 35.55344,-90.037615 35.550329,-90.039744 35.548041,-90.041962 35.537468,-90.044748 35.531657,-90.046227 35.529592,-90.04909 35.522257,-90.050277 35.515275,-90.0482761 35.5040275,-90.046829 35.5008836,-90.0459931 35.4986041,-90.0445723 35.4952188,-90.0433185 35.4932623,-90.0389514 35.4869164,-90.0360052 35.4834114,-90.03145 35.4797021,-90.0285873 35.4777113,-90.0261843 35.476367,-90.0220889 35.4746483,-90.0195396 35.4729126,-90.0166143 35.469407,-90.0130412 35.4643696,-90.0094472 35.458549,-90.0071696 35.4541577,-90.0058323 35.4504981,-90.0037009 35.4416123,-90.0027606 35.4347345,-90.0026353 35.4299503,-90.0124352 35.4241612,-90.0156531 35.4224244,-90.0201665 35.4214028,-90.0223814 35.4212836,-90.0295067 35.4216412,-90.0327037 35.4210111,-90.0371126 35.4194105,-90.041835 35.4169924,-90.0516976 35.4087501,-90.061999 35.3987525,-90.0695631 35.4080689,-90.062018 35.41518,-90.070549 35.423291,-90.074082 35.433983,-90.074063 35.439611,-90.071327 35.450338,-90.067206 35.460957,-90.067138 35.464833,-90.067798 35.466224,-90.072154 35.470752,-90.080128 35.476844,-90.085009 35.478835,-90.098719 35.478595,-90.101759 35.476889,-90.1077602 35.476919,-90.114412 35.472467,-90.11839 35.468791,-90.120619 35.465741,-90.123142 35.459853,-90.129448 35.441931,-90.1402582 35.4364441,-90.169002 35.421853,-90.170599 35.418352,-90.1707 35.410065,-90.179265 35.385194,-90.178341 35.382092,-90.172388 35.377681,-90.166246 35.374745,-90.144924 35.374633,-90.13551 35.376668,-90.143475 35.387602,-90.14587 35.395079,-90.146191 35.399468,-90.145085 35.403757,-90.143448 35.406671,-90.14166 35.408563,-90.137881 35.41151,-90.135125 35.412977,-90.130475 35.413745,-90.116902 35.411692,-90.112504 35.410153,-90.110543 35.408595,-90.106775 35.403339,-90.104842 35.401487,-90.09665 35.395257,-90.093589 35.393333,-90.087743 35.390838,-90.0806579 35.3857906,-90.0895836 35.3703898,-90.0917375 35.3661746,-90.0927519 35.3605353,-90.093492 35.360486,-90.096825 35.357216,-90.100294 35.351619,-90.107312 35.343143,-90.108817 35.342587,-90.110293 35.342786,-90.103862 35.332405,-90.106824 35.324618,-90.109093 35.304987,-90.117219 35.303384,-90.121864 35.304535,-90.123707 35.30453,-90.132393 35.300488,-90.139504 35.298828,-90.149794 35.303288,-90.153394 35.302588,-90.158913 35.300637,-90.161225 35.298951,-90.163812 35.296115,-90.165194 35.293188,-90.168871 35.281997,-90.168794 35.279088,-90.166594 35.274588,-90.158865 35.262577,-90.152094 35.255989,-90.140394 35.252289,-90.132116 35.25318,-90.123593 35.254989,-90.116493 35.255788,-90.110106 35.255456,-90.105093 35.254288,-90.09949 35.251393,-90.097947 35.249983,-90.090892 35.242189,-90.086322 35.235719,-90.082939 35.231824,-90.0808712 35.2279063,-90.0794578 35.2234307,-90.0782801 35.2198974,-90.0782801 35.2174241,-90.0788689 35.2156574,-90.0804001 35.2148329,-90.082049 35.2140085,-90.0844045 35.214244,-90.0868779 35.2137729,-90.088597 35.212376,-90.093285 35.203282,-90.096466 35.194848,-90.097408 35.194794,-90.109076 35.199105,-90.116182 35.198498,-90.117542 35.19057,-90.117393 35.18789,-90.114214 35.181691,-90.111091 35.178639,-90.109177 35.178451,-90.109286 35.174769,-90.108607 35.169111,-90.107026 35.166685,-90.102816 35.163131,-90.098493 35.16029,-90.092836 35.157693,-90.088688 35.156622,-90.069402 35.153646,-90.068644 35.153149,-90.0684784 35.1530403,-90.067792 35.15259,-90.066958 35.151839,-90.066482 35.151074,-90.066281 35.150004,-90.065607 35.146247,-90.064831 35.141862,-90.064785 35.1416,-90.064612 35.140621,-90.064768 35.13894,-90.065003 35.138468,-90.065392 35.137691,-90.066365 35.13631,-90.066591 35.13599,-90.068091 35.13459,-90.069977 35.132765,-90.071192 35.131591,-90.071491 35.131411,-90.072391 35.13087,-90.072692 35.130691,-90.073103 35.130345,-90.074337 35.129308,-90.074749 35.128963,-90.074837 35.128888,-90.075103 35.128665,-90.075264 35.128519,-90.075512 35.128271,-90.075688 35.128094,-90.075725 35.128058,-90.075785 35.127997,-90.075968 35.127814,-90.075977 35.127804,-90.075992 35.127791,-90.076036 35.127755,-90.076091 35.127708,-90.078095 35.126056,-90.08342 35.12167,-90.084392 35.121111,-90.085274 35.120604,-90.08671 35.119779,-90.09061 35.118287,-90.093112 35.117737,-90.096515 35.117131,-90.100593 35.116691,-90.101501 35.116917,-90.103634 35.117451,-90.109393 35.118891,-90.132258 35.130279,-90.132865 35.130673,-90.134159 35.131511,-90.139024 35.133995,-90.141253 35.134728,-90.141357 35.134753,-90.142794 35.135091,-90.143629 35.135139,-90.144691 35.134984,-90.148683 35.133275,-90.151452 35.132409,-90.155994 35.130991,-90.160058 35.12883,-90.165328 35.125228,-90.16775 35.123268,-90.167951 35.123107,-90.169816 35.121326,-90.170917 35.120379,-90.172002 35.119448,-90.172184 35.11929,-90.172734 35.118819,-90.173603 35.118073,-90.174594 35.116682,-90.175821 35.114051,-90.175944 35.113814,-90.176843 35.112088,-90.179995 35.097792,-90.180156 35.09705,-90.181387 35.091401,-90.182065 35.089785,-90.195873 35.060208,-90.19706 35.053407,-90.197221 35.048381,-90.19695 35.044174,-90.195817 35.037788,-90.196099 35.037395,-90.196694 35.036777,-90.198072 35.035347,-90.199349 35.033757,-90.200045 35.032893,-90.200222 35.032743,-90.200334 35.032666,-90.20067 35.032439,-90.200783 35.032364,-90.202505 35.0312,-90.207674 35.027709,-90.209397 35.026546,-90.21355 35.0259203,-90.214382 35.025795,-90.216258 35.026049,-90.224791 35.029961,-90.230611 35.03132,-90.256495 35.034493,-90.262396 35.036393,-90.263396 35.037493,-90.263796 35.039593,-90.265296 35.040293,-90.291996 35.041793,-90.295596 35.040093,-90.297296 35.037893,-90.300697 35.028793,-90.306897 35.018194,-90.309877 35.00975,-90.310298 35.004295)))'
    private static String convertGeoEncodedPolygonToSQLData(double[][][] polygon)
    {
        StringBuilder builder = new StringBuilder();
        builder.append("(");
        for (int i = 0; i < polygon.length; i++)
        {
            double[][] b = polygon[i];
            builder.append("(");
            for (int j = 0; j < b.length; j++)
            {
                double c[] = b[j];
                builder.append(c[0]+" "+c[1]);
                if (j < b.length - 1)
                    builder.append(",");
            }
            builder.append(")");
            if (i < polygon.length - 1)
                builder.append(",");
        }
        builder.append(")");
        return builder.toString();
    }

    static Pattern p = Pattern.compile("(.*?)[:;]");

    public static List<String> getLocations(String rawLocation)
    {
        List<String> locations = new LinkedList<>();
        List<String> tokens = new LinkedList<>();
        Matcher m = p.matcher(rawLocation);
        while (m.find())
        {
            tokens.add(m.group());
        }

        String currentLocation = "";
        while (!tokens.isEmpty())
        {
            String token = tokens.remove(0).trim();
            if (StringUtils.isBlank(currentLocation))
            {
                if (!tokens.isEmpty())
                    currentLocation = token;
                else
                    locations.add(clean(token));
            }
            else
            {
                if (!tokens.isEmpty())
                {
                    String nextToken = token;
                    if (nextToken.endsWith(":"))
                    {
                        locations.add(clean(token));
                        locations.add(clean(currentLocation));
                        currentLocation = "";
                    }
                    else if (nextToken.endsWith(";")) {
                        for (String county : nextToken.split(",")) {
                            locations.add(clean(county + ", " + currentLocation));
                        }
                        currentLocation = "";
                    }
                }
                else
                {
                    if (token.endsWith(":"))
                    {
                        locations.add(clean(currentLocation));
                        locations.add(clean(token));
                    }
                    else if (token.endsWith(";")) {
                        for (String county : token.split(",")) {
                            locations.add(clean(county + ", " + currentLocation));
                        }
                    }
                }
            }
        }

        return locations;
    }

    private static String clean(String s)
    {
        return s.replaceAll(";", "").replaceAll(":", "");
    }

    private static Connection initConnection() throws SQLException, ClassNotFoundException {
        Connection c = null;
        Class.forName("org.postgresql.Driver");
        c = DriverManager
                .getConnection("jdbc:postgresql://localhost:5432/",
                        "Alex_Lappy_486", "Alex_Lappy_486");
        c.setAutoCommit(false);
        System.out.println("Opened database successfully");
        return c;
    }



    private static List<OutageSample> parseOutagesFromExcelFiles(List<File> files) throws IOException, InvalidFormatException, ParseException
    {
        List<OutageSample> samples = new LinkedList<>();
        for (File f : files)
        {
            if (f.toString().contains("2018"))
            {
                Workbook workbook = WorkbookFactory.create(f);
                System.out.println("Retrieving Sheets using for-each loop");
                for(Sheet sheet: workbook) {
                    int rowNum = 0;
                    for (Row row: sheet)
                    {
                        OutageSample outage = getOutageFromRowVals(f.getName(), row, rowNum);
                        if (outage != null && outage.sampleIsUsable())
                            samples.add(outage);

                        rowNum++;
                    }
                }
            }

        }
        return samples;
    }

    private static OutageSample getOutageFromRowVals(String fileSource, Row row, int rowNum) throws ParseException {
        DOEFieldOrder fieldParser = getRowParser(row);
        OutageSample outage = null;
        String[] vals = getValues(row);
        try {
            if (rowContainsValues(vals)) {
                outage = new OutageSample();
                outage.setId(rowNum);
                outage.setSource(fileSource);
                outage.setAreaAffected(LossyParser.getVal(row, fieldParser.getAreaAffectedCol()));
                outage.setDisturbanceType(LossyParser.getVal(row, fieldParser.getEventTypeCol()));
                outage.setEnergyLossInMegaWatts(LossyParser.getInt(row, fieldParser.getLossCol()));
                outage.setNercRegion(LossyParser.getNerc(row, fieldParser.getNercRegionCol()));
                outage.setNumCustomersAffected(LossyParser.getInt(row, fieldParser.getNumAffectedCol()));

                String dateOcurredString = LossyParser.getVal(row, fieldParser.getDateOccurredCol());
                String timeOcurredString = LossyParser.getVal(row, fieldParser.getTimeOccurredCol());
                outage.setDateTimeOcurred(fieldParser.getDateFormat().parse(dateOcurredString+" "+timeOcurredString));

                String dateRestoredStr = LossyParser.getVal(row, fieldParser.getDateRestoredCol());
                String timeRestoredStr = LossyParser.getVal(row, fieldParser.getTimeRestoredCol());
                try {
                    outage.setRestorationDateTime(fieldParser.getDateFormat().parse(dateRestoredStr+" "+timeRestoredStr));
                }
                catch(Exception e){}


                doDOEFieldOrderSpecificProcessing(fieldParser, outage, vals);
            }
        }
        catch(Exception e)
        {
            System.out.println(e.getMessage());
        }

        return outage;
    }

    private static void doDOEFieldOrderSpecificProcessing(DOEFieldOrder fieldOrder, OutageSample outage, String[] vals)
    {
        if (fieldOrder instanceof DOE2002FieldOrder)
        {
            DOE2002FieldOrder o = (DOE2002FieldOrder) fieldOrder;
            String[] tokens = vals[fieldOrder.getDateRestoredCol()].split(" ");
            if (tokens.length == 1) {
                try {
                    Date d = o.getAltDateFormat2().parse(tokens[0]);
                    d.setYear(outage.getDateTimeOcurred().getYear());
                    outage.setRestorationDateTime(d);
                } catch (ParseException e) {
                    e.printStackTrace();
                }
            }
            else if (tokens.length == 2)
            {
                try {
                    String v = vals[fieldOrder.getDateRestoredCol()];
                    Date d = o.getAltDateFormat1().parse(v);
                    outage.setRestorationDateTime(d);
                }
                catch(Exception e) {}
            }
            else if (tokens.length == 3)
            {
                tokens = vals[fieldOrder.getDateRestoredCol()].split("[,\\s]+");
                try {
                    // Convert noon to "pm" and remove periods in "a.m."
                    if (tokens[2].contains("noon"))
                        tokens[2] = "pm";

                    tokens[2] = tokens[2].trim().replaceAll("\\.", "");
                    Date d = o.get2003RestoredDateFormat().parse(tokens[0]+" "+tokens[1]+" "+tokens[2]);
                    outage.setRestorationDateTime(d);
                }
                catch(Exception e) {}
            }
        }
    }

    private static String[] getValues(Row row)
    {
        String [] vals = new String[getNumValues(row)];
        int i = 0;
        for (Cell cell : row)
        {
            vals[i] = LossyParser.dataFormatter.formatCellValue(cell);
            i++;
        }
        return vals;
    }



    private static DOEFieldOrder getRowParser(Row row)
    {
        String[] vals = getValues(row);
        for (String val : vals)
        {
            // Try 2018
            DOEFieldOrder fieldOrder = new DOE2018FieldOrder();
            Date date = tryToParseDate(fieldOrder, val);
            if (date != null && dateHasYear(date, 118, 117, 116, 115))
                return fieldOrder;
            else if (date != null && dateHasYear(date, 115, 114, 113, 112, 111))
                return new DOE2012FieldOrder();

            // Try 2002
            fieldOrder = new DOE2002FieldOrder();
            date = tryToParseDate(fieldOrder, val);
            if (date != null && dateHasYear(date, 102, 103, 104, 105, 106, 107, 108, 109, 110))
                return fieldOrder;
            else if (date != null && dateHasYear(date, 111, 112, 113, 114))
                return new DOE2011FieldOrder();
            else{
                Date d = tryToParseDate(new DOE2015FieldOrder(), val);
                if (d != null && dateHasYear(d,  115))
                    return new DOE2015FieldOrder();
            }
        }
        System.err.print("couldn't find parser!");
        return null;
    }

    private static boolean dateHasYear(Date date, int...years)
    {
        for (int year : years)
        {
            if (date.getYear() == year)
                return true;
        }
        return false;
    }

    private static Date tryToParseDate(DOEFieldOrder order, String val)
    {
        try {
            return order.dateFormatForFileDetection().parse(val);
        }
        catch(Exception e){}
        return null;
    }

    private static boolean rowContainsValues(String[] row)
    {
        int notBlank = 0;
        for (String s : row) {
            if (StringUtils.isNotBlank(s))
                notBlank++;
        }
        return notBlank > 5;

    }

    private static int getNumValues(Row row)
    {
        int count = 0;
        for (Cell cell : row)
        {
            count++;
        }
        return count;
    }

}
